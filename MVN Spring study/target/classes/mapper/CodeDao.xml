<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.study.spring.db.dao.CodeDao">

    <resultMap type="com.study.spring.db.domain.Code" id="codeMap">
        <id     column="CDNO"       property="CDNO"/>
        <result column="CDLVL"      property="CDLVL"/>
        <result column="UPCD"       property="UPCD"/>
        <result column="CDNAME"     property="CDNAME"/>
        <result column="INSUSER"    property="INSUSER"/>
        <result column="INSDATE"    property="INSDATE"/>
        <result column="USEYN"      property="USEYN"/>
    </resultMap>
    
    <select id="showAll" resultType="map" > <!-- resultMap="codeMap"  resultType="com.study.spring.db.domain.Code" --> 
        SELECT CDNO
                , CDLVL
                , UPCD
                , CDNAME
                , INSUSER
                , INSDATE
                , USEYN
        FROM    CODEMNG
        ORDER BY    CDNO ASC
    </select>
    
    <insert id="insert" parameterType="string">
        INSERT INTO CODEMNG (CDNO, CDLVL, UPCD, CDNAME, INSUSER, INSDATE, USEYN)
        VALUES (
            (select concat('C',lpad(substr(max(CDNO),2)+1,4,'0')) from CODEMNG),
             ${CDLVL}, '${UPCD}', '${CDNAME}', '${INSUSER}', SYSDATE, '${USEYN}')
    </insert>
    
    <update id="update" parameterType="string">
        UPDATE CODEMNG
        <trim prefix="SET" suffixOverrides=",">
            <if test="CDLVL != null and CDLVL != '' ">  CDLVL = #{CDLVL},</if>
            <if test="UPCD != null and UPCD != ''">     UPCD = #{UPCD},</if>
            <if test="CDNAME != null and CDNAME != '' ">CDNAME = #{CDNAME},</if>
            <if test="USEYN != null and USEYN != '' ">  USEYN = #{USEYN},</if>
        </trim>
        WHERE
            CDNO = #{CDNO}
    </update>
    
</mapper>
